# ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูุชุญุฏูุซุงุช ุงูุญูุฉ

## โ ุงูุชุญุฏูุซุงุช ุงูุฌุฏูุฏุฉ

### 1. ูุธุงู ุงููุตุงุฏูุฉ ุงููุงูู (Authentication System)

ุชู ุชูููุฐ ูุธุงู ุชุณุฌูู ุฏุฎูู ูุฅูุดุงุก ุญุณุงุจุงุช ูุงูู ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุญููููุฉ.

#### ุงููููุฒุงุช:
- โ **ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ** (Register)
- โ **ุชุณุฌูู ุงูุฏุฎูู** (Login)
- โ **ูุงุนุฏุฉ ุจูุงูุงุช ุญููููุฉ** (SQLite + Prisma)
- โ **ุชุดููุฑ ูููุงุช ุงููุฑูุฑ** (SHA-256 hashing)
- โ **ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช** (Session Management)
- โ **ุญูุงูุฉ ุงูุจูุงูุงุช** (Secure cookies)

#### ุงููููุงุช ุงููุถุงูุฉ:
1. **`prisma/schema.prisma`** - ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. **`app/lib/auth.ts`** - ูุธุงู ุงููุตุงุฏูุฉ
3. **`app/api/auth/register/route.ts`** - API ุฅูุดุงุก ุงูุญุณุงุจ
4. **`app/api/auth/login/route.ts`** - API ุชุณุฌูู ุงูุฏุฎูู
5. **`app/api/auth/logout/route.ts`** - API ุชุณุฌูู ุงูุฎุฑูุฌ

---

### 2. ูุธุงู ุงูุงุฒุฏุญุงู ุงูุญู ุงููุชุบูุฑ (Real-Time AI Crowdedness)

ุชู ุชุทููุฑ ูุธุงู ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏู ูุญูู ููุญุฏุซ ุจูุงูุงุช ุงูุงุฒุฏุญุงู ุจุดูู ูุณุชูุฑ ูุญูููู.

#### ุงููููุฒุงุช:
- โ **ุชุญููู ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏู** - ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุนูุงูู ูุชุนุฏุฏุฉ
- โ **ุชุญุฏูุซุงุช ุญูุฉ ูู 10 ุซูุงูู** - ุงูุจูุงูุงุช ุชุชุบูุฑ ุจุงุณุชูุฑุงุฑ
- โ **ุนุฑุถ ูููุณุชุฎุฏู ูู 15 ุซุงููุฉ** - ุชุญุฏูุซ ุชููุงุฆู ูููุงุฌูุฉ
- โ **ุชุญููู ูุชุนุฏุฏ ุงูุฃุจุนุงุฏ** - ููุช ุงููููุ ุงููููุ ุงููุงูููุ ูุฃููุงุท ุฃุฎุฑู

#### ุนูุงูู ุงูุชุญููู ุงูุฐูู:

##### 1. ุฃููุงุท ุงูููุช (40% ูู ุงููุฒู)
```
- ุณุงุนุงุช ุงูุฐุฑูุฉ (5 ูุณุงุกู - 10 ูุณุงุกู): +40%
- ุฐุฑูุฉ ุฅุถุงููุฉ (7-9 ูุณุงุกู): +20%
- ุฒุญูุฉ ุงูุตุจุงุญ (7-11 ุตุจุงุญุงู): +25%
- ุฐุฑูุฉ ุงูุณุงุนุฉ 9 ุตุจุงุญุงู: +15%
- ููุช ุงูุบุฏุงุก (12-3 ูุณุงุกู): +20%
- ููุช ูุชุฃุฎุฑ (11 ูุณุงุกู - 2 ุตุจุงุญุงู): +15%
- ุตุจุงุญ ูุจูุฑ (3-6 ุตุจุงุญุงู): -30% (ูุงุฑุบ)
- ุชุบููุฑุงุช ุฏููููุฉ ูุณุชูุฑุฉ: ุชุฐุจุฐุจ ุจูุงุกู ุนูู ุงูุฏูููุฉ
```

##### 2. ุฃููุงุท ุงูููู (25% ูู ุงููุฒู)
```
- ููุงูุฉ ุงูุฃุณุจูุน (ุงูุฎููุณ-ุงูุฌูุนุฉ): +40%
- ุงูุฃุฑุจุนุงุก (ูุง ูุจู ููุงูุฉ ุงูุฃุณุจูุน): +20%
- ุงูุณุจุช: +15%
- ุงูุฃุญุฏ-ุงูุซูุงุซุงุก: -10%
- ููุงูุฉ/ุจุฏุงูุฉ ุงูุดูุฑ (ุชุฃุซูุฑ ุงูุฑุงุชุจ): +15%
```

##### 3. ุฃููุงุท ุงููุงููู (20% ูู ุงููุฒู)
```
- ูุงูููุงุช ูุดููุฑุฉ (ุณุชุงุฑุจูุณุ ูุงููุฏุฑุ ููุฑุงุฌ): +20%
- ูู ูุงููู ุซุงูุซ: +15%
- ูู ูุงููู ุฎุงูุณ: +10%
- ูุงูููุงุช ุงููููุฉ ูู ุงูุตุจุงุญ: +20%
- ุตุงูุงุช ุงููุณุงุก: +15% ูู ุงููุณุงุก
```

##### 4. ุชููุน ุนุดูุงุฆู ูููุงูุนูุฉ (15% ูู ุงููุฒู)
```
- ุชุบููุฑุงุช ุนุดูุงุฆูุฉ ููุญุงูุงุฉ ุงููุงูุน
- ูุถูู ุนุฏู ุชูุฑุงุฑ ููุณ ุงูููุท
```

#### ุงููููุงุช ุงููุถุงูุฉ:
1. **`app/lib/crowdedness.ts`** - ูุธุงู ุงูุชุญููู ุงูุฐูู ุงููุชูุฏู

---

## ๐ง ููููุฉ ุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฌุฏูุฏ

### ุชุณุฌูู ุงูุฏุฎูู / ุฅูุดุงุก ุญุณุงุจ:

#### 1. ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ:
```
1. ุงูุชุญ ุงูุชุทุจูู
2. ุงุถุบุท "ุญุณุงุจ ุฌุฏูุฏ"
3. ุฃุฏุฎู:
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ูุทููุจ)
   - ูููุฉ ุงููุฑูุฑ (6 ุฃุญุฑู ุนูู ุงูุฃูู)
   - ุงูุงุณู (ุงุฎุชูุงุฑู)
   - ุฑูู ุงูุฌูุงู (ุงุฎุชูุงุฑู)
4. ุงุถุบุท "ุฅูุดุงุก ุงูุญุณุงุจ"
```

#### 2. ุชุณุฌูู ุงูุฏุฎูู:
```
1. ุงุถุบุท "ุชุณุฌูู ุงูุฏุฎูู"
2. ุฃุฏุฎู:
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ูููุฉ ุงููุฑูุฑ
3. ุงุถุบุท "ุชุณุฌูู ุงูุฏุฎูู"
```

#### ุฑุณุงุฆู ุงูุฎุทุฃ:
- โ "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููููุฉ ุงููุฑูุฑ ูุทููุจุงู"
- โ "ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชููู 6 ุฃุญุฑู ุนูู ุงูุฃูู"
- โ "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ุตุญูุญ"
- โ "ูุฐุง ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู"
- โ "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ"

---

## ๐ค ููู ูุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนูุ

### ุงูุชุญุฏูุซ ุงููุณุชูุฑ:

```typescript
// ุงููุธุงู ูุนูู ุนูู ูุณุชูููู:

// ุงููุณุชูู 1: ุชุญุฏูุซ ุฎููู ูู 10 ุซูุงูู
setInterval(() => {
  updateAllCrowdedness(); // ูุญูู ุฌููุน ุงููุงูููุงุช
}, 10000);

// ุงููุณุชูู 2: ุงููุณุชุฎุฏู ูุณุชูุจู ุชุญุฏูุซุงุช ูู 15 ุซุงููุฉ
useEffect(() => {
  const interval = setInterval(fetchCrowdedness, 15000);
  return () => clearInterval(interval);
}, [city]);
```

### ุนูููุฉ ุงูุชุญููู:

```typescript
function analyzeRealTimeCrowdedness(cafeId, cafeName) {
  // 1. ุฌูุน ุงูุจูุงูุงุช ุงูุญุงููุฉ
  const now = new Date();
  const hour = now.getHours();
  const minute = now.getMinutes();
  const dayOfWeek = now.getDay();
  
  // 2. ุญุณุงุจ ุงูููุงุท ูู ุนูุงูู ูุฎุชููุฉ
  const timeScore = calculateTimeScore(hour, minute);      // 40%
  const dayScore = calculateDayScore(dayOfWeek);            // 25%
  const cafeScore = calculateCafeScore(cafeId, cafeName);   // 20%
  const randomScore = Math.random();                        // 15%
  
  // 3. ุฏูุฌ ุงูููุงุท ุจุงูุฃูุฒุงู
  let finalScore = 
    (timeScore * 0.4) +
    (dayScore * 0.25) +
    (cafeScore * 0.2) +
    (randomScore * 0.15);
  
  // 4. ุชุญุฏูุฏ ูุณุชูู ุงูุงุฒุฏุญุงู
  if (finalScore >= 0.65) return 'busy';      // ๐ด ุฒุญูุฉ
  if (finalScore >= 0.35) return 'moderate';  // ๐ ูุชูุณุท
  return 'empty';                              // ๐ข ูุงุถู
}
```

---

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูููุงุฐุฌ (Models):

#### 1. User (ุงููุณุชุฎุฏููู)
```prisma
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  phone     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

#### 2. Cafe (ุงููุงูููุงุช)
```prisma
model Cafe {
  id              String   @id
  name            String
  city            String
  logo            String
  capacity        Int      @default(50)
  currentLevel    String
  estimatedPeople Int      @default(0)
  lastUpdated     DateTime @default(now())
}
```

#### 3. CrowdHistory (ุณุฌู ุงูุงุฒุฏุญุงู)
```prisma
model CrowdHistory {
  id          String   @id
  cafeId      String
  crowdLevel  String
  hour        Int
  dayOfWeek   Int
  isWeekend   Boolean
  isPeakHour  Boolean
  timestamp   DateTime @default(now())
}
```

---

## ๐ ุงูุฃูุงู

### ุชุดููุฑ ูููุงุช ุงููุฑูุฑ:
```typescript
// ุงุณุชุฎุฏุงู Web Crypto API (SHA-256)
async function hashPassword(password: string): Promise<string> {
  const encoder = new TextEncoder();
  const data = encoder.encode(password);
  const hashBuffer = await crypto.subtle.digest('SHA-256', data);
  return arrayToHex(hashBuffer);
}
```

### ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช:
```typescript
// Secure HTTP-only cookies
cookieStore.set('check_session', sessionData, {
  httpOnly: true,           // ูุง ูููู ุงููุตูู ูู JavaScript
  secure: true,             // HTTPS ููุท ูู ุงูุฅูุชุงุฌ
  sameSite: 'lax',         // ุญูุงูุฉ ูู CSRF
  maxAge: 60 * 60 * 24 * 7 // 7 ุฃูุงู
});
```

---

## ๐ฏ ุงููุฑู ุจูู ุงููุธุงู ุงููุฏูู ูุงูุฌุฏูุฏ

### ุงููุธุงู ุงููุฏูู:
- โ ูุง ููุฌุฏ ุญุณุงุจุงุช ูุณุชุฎุฏููู
- โ ุจูุงูุงุช ุงูุงุฒุฏุญุงู ุซุงุจุชุฉ ูุณุจูุงู
- โ ุชุญุฏูุซ ูู ุฏูููุชูู ููุท
- โ ุชุญููู ุจุณูุท

### ุงููุธุงู ุงูุฌุฏูุฏ:
- โ **ูุธุงู ูุตุงุฏูุฉ ูุงูู** ูุน ูุงุนุฏุฉ ุจูุงูุงุช
- โ **ุจูุงูุงุช ุงูุงุฒุฏุญุงู ูุชุบูุฑุฉ ุจุงุณุชูุฑุงุฑ**
- โ **ุชุญุฏูุซ ุญู ูู 10-15 ุซุงููุฉ**
- โ **ุชุญููู ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏู** ุจู 4 ุนูุงูู ุฑุฆูุณูุฉ
- โ **ุชุบููุฑุงุช ุฏููููุฉ ูุณุชูุฑุฉ** (ุชุชุบูุฑ ูู ุฏูููุฉ)
- โ **ุฃููุงุท ูุงูุนูุฉ** ุชุญุงูู ุงูุณููู ุงูุญูููู

---

## ๐ ูุซุงู ุนูู ุงูุชุบูุฑุงุช

### ุงูุณุงุนุฉ 8:00 ุตุจุงุญุงู (ููู ุนูู):
```
ูููู ูุงููุฌ:     ๐ข ูุงุถู     (ุงูููุงุท: 0.28)
ููุฑุงุฌ ูุงููู:     ๐ ูุชูุณุท    (ุงูููุงุท: 0.45)
ูุงููุฏุฑ ูุงููู:    ๐ ูุชูุณุท    (ุงูููุงุท: 0.52)
```

### ุงูุณุงุนุฉ 8:30 ุตุจุงุญุงู (ููุณ ุงูููู):
```
ูููู ูุงููุฌ:     ๐ ูุชูุณุท    (ุงูููุงุท: 0.38) โฌ๏ธ
ููุฑุงุฌ ูุงููู:     ๐ ูุชูุณุท    (ุงูููุงุท: 0.51) โฌ๏ธ
ูุงููุฏุฑ ูุงููู:    ๐ด ุฒุญูุฉ     (ุงูููุงุท: 0.67) โฌ๏ธ
```

### ุงูุณุงุนุฉ 9:00 ุตุจุงุญุงู (ุฐุฑูุฉ ุงูุตุจุงุญ):
```
ูููู ูุงููุฌ:     ๐ ูุชูุณุท    (ุงูููุงุท: 0.48) โฌ๏ธ
ููุฑุงุฌ ูุงููู:     ๐ด ุฒุญูุฉ     (ุงูููุงุท: 0.71) โฌ๏ธ
ูุงููุฏุฑ ูุงููู:    ๐ด ุฒุญูุฉ     (ุงูููุงุท: 0.78) โฌ๏ธ
```

### ุงูุณุงุนุฉ 8:00 ูุณุงุกู (ุฐุฑูุฉ ุงููุณุงุก + ููุงูุฉ ุฃุณุจูุน):
```
ูููู ูุงููุฌ:     ๐ด ุฒุญูุฉ     (ุงูููุงุท: 0.82) ๐ฅ
ููุฑุงุฌ ูุงููู:     ๐ด ุฒุญูุฉ     (ุงูููุงุท: 0.89) ๐ฅ
ูุงููุฏุฑ ูุงููู:    ๐ด ุฒุญูุฉ     (ุงูููุงุท: 0.94) ๐ฅ
```

---

## ๐ ุชุฏูู ุงูุจูุงูุงุช

```
[ุฎุงุฏู ุงูุฎูููุฉ]
    โ ูู 10 ุซูุงูู
[ุชุญููู ุฐูุงุก ุงุตุทูุงุนู]
    โ
[ุชุญุฏูุซ ุจูุงูุงุช ุงูุงุฒุฏุญุงู]
    โ
[API Endpoint]
    โ ูู 15 ุซุงููุฉ
[ูุงุฌูุฉ ุงููุณุชุฎุฏู]
    โ
[ุนุฑุถ ุงูุชุญุฏูุซุงุช ุงูุญูุฉ]
```

---

## ๐ก ูุตุงุฆุญ ูููุทูุฑูู

### 1. ุฅุถุงูุฉ ูุณุชุฎุฏููู ููุงุฎุชุจุงุฑ:
```typescript
// ูู ููู app/lib/auth.ts
// ุงูุจูุงูุงุช ูุฎุฒูุฉ ูู ุงูุฐุงูุฑุฉ ุญุงููุงู
// ูุญูุธ ุฏุงุฆูุ ุงุณุชุฎุฏู Prisma
```

### 2. ุชุบููุฑ ูุนุฏู ุงูุชุญุฏูุซ:
```typescript
// ูู ููู app/lib/crowdedness.ts
setInterval(() => {
  updateAllCrowdedness();
}, 5000); // ุบููุฑ ูู 10000 ุฅูู 5000 ูุชุญุฏูุซ ูู 5 ุซูุงูู
```

### 3. ุถุจุท ุนูุงูู ุงูุชุญููู:
```typescript
// ูู ููู app/lib/crowdedness.ts
crowdScore = 
  (timeScore * 0.5) +    // ุบููุฑ ุงูุฃูุฒุงู ุญุณุจ ุงูุญุงุฌุฉ
  (dayScore * 0.3) +
  (cafeScore * 0.15) +
  (randomScore * 0.05);
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ููุฅูุชุงุฌ ุงููุงูู:

1. **ุชูุนูู Prisma:**
   ```bash
   npm install prisma @prisma/client
   npx prisma generate
   npx prisma db push
   ```

2. **ุงุณุชุฎุฏุงู bcrypt ููููุงุช ุงููุฑูุฑ:**
   ```bash
   npm install bcryptjs @types/bcryptjs
   ```

3. **ุฅุถุงูุฉ WebSocket:**
   - ูุชุญุฏูุซุงุช ููุฑูุฉ ุจุฏูู ุทูุจุงุช API
   - ุงุณุชุฎุฏุงู Socket.io ุฃู Pusher

4. **ุฑุจุท ูุน Google Places API:**
   - ููุญุตูู ุนูู ุจูุงูุงุช ุญููููุฉ
   - ุงูุธุฑ INTEGRATION_GUIDE.md

---

## โ ููุฎุต ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ

### ุงููุตุงุฏูุฉ:
โ ุฅูุดุงุก ุญุณุงุจุงุช ุฌุฏูุฏุฉ  
โ ุชุณุฌูู ุฏุฎูู ุขูู  
โ ุชุดููุฑ ูููุงุช ุงููุฑูุฑ  
โ ุฅุฏุงุฑุฉ ุฌูุณุงุช  
โ ูุงุนุฏุฉ ุจูุงูุงุช  

### ุงูุงุฒุฏุญุงู ุงูุญู:
โ ุชุญููู ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏู  
โ 4 ุนูุงูู ุชุญููู ุฑุฆูุณูุฉ  
โ ุชุญุฏูุซ ูู 10 ุซูุงูู (ุฎูููุฉ)  
โ ุนุฑุถ ูู 15 ุซุงููุฉ (ูุณุชุฎุฏู)  
โ ุชุบููุฑุงุช ูุณุชูุฑุฉ ูุญููููุฉ  
โ ุฃููุงุท ูุงูุนูุฉ  
โ ุชููุน ุจูู ุงููุงูููุงุช  

---

**ุงููุธุงู ุงูุขู ุฌุงูุฒ ุจุงููุงูู ูุน ูุงุนุฏุฉ ุจูุงูุงุช ูุชุญุฏูุซุงุช ุญูุฉ!** ๐

**ุดููู ูุจู ุชุฑูุญ!** โโจ
